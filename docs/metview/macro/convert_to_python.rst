.. _macro_to_python:

Convert Macros to Python
==========================

.. note::

    The Macro to Python converter is available from Metview version 5.19.0

How to use the converter?
--------------------------

There are different ways to perform the conversion. 

Conversion from the icon context menu
++++++++++++++++++++++++++++++++++++++++

In the :ref:`user interface <mv_desktop_overview>` if we right-click on any Macro icon we can use the **Convert to Python** action. 

.. image:: /_static/ui/macro_convert_context_menu.png
   :width: 250px

It will generate a Python script in the same folder where the Macro is located. The name of the Python script is generated by adding the ".py" suffix to the file name or if the Macro name contains the ".mv" suffix it is replaced by ".py". Subsequent calls will always generate a new Python script with an increment added to the file name.

.. image:: /_static/ui/macro_convert_result_1.png
   :width: 250px

The conversion also works for multiple selected Macros:

.. image:: /_static/ui/macro_convert_context_menu_multi.png
   :width: 300px

It the conversion fails for a given Macro its name turns red and the error message will be avialable in icon Log (start it from the icon context menu):

.. image:: /_static/ui/macro_convert_error_log.png
   :width: 300px

Conversion from the Macro Editor
++++++++++++++++++++++++++++++++++++++++

In the Macro editor we can use the **Convert to Python** action from the File menu in the menubar:

.. image:: /_static/ui/macro_convert_from_editor.png
   :width: 300px

It will generate a Python script in the same folder where the Macro is located. The name of the Python script is generated by adding the ".py" suffix to the file name or if the Macro name contains the ".mv" suffix it is replaced by ".py". Subsequent calls will always generate a new Python script with an increment added to the file name.

On success a popup dialog appears showing the path to the generated Python script. If an error happens the popup will contain the error message as to why the conversion failed.

