FLEXPART Macro functions
============================

.. describe:: fieldset flexpart_filter(...)

   Extract fields from FLEXPART output GRIB files. This function uses this set of keyword arguments:

   **source**

   The FLEXPART output GRIB file.

   **data**

   The FLEXPART output GRIB as a fieldset. It takes precedence over source.

   **param**

   The shortName of the parameter to extract.

   **levType**

   The type of level to extract. The possible values are: "hl" and "sfc". The default is "hl".

   **level**

   The level to extract.

   **step**

   The forecast step to extract.

   **release**

   The release to extract. Release indexing starts at 1.

   **ageclass**

   The ageclass to extract. Ageclass indexing starts at 1.

   Example:

   # to read parameter mdc (mass density concentration) for level 5000 m, for all the timesteps, releases and ageclasses

   g=flexpart_filter(source: "my_flexpart_output.grib",param: "mdc",level: 5000)


.. describe:: fieldset flexpart_total_column(...)

   Computes the sum/vertical integral of fields in a FLEXPART output GRIB file. This function uses this set of keyword arguments:

   source

   The FLEXPART output GRIB file.

   data

   The FLEXPART output GRIB as a fieldset. It takes precedence over source

   param

   The shortname of the GRIB parameter. If param is "mdc" (mass density concentration) the column integrated mass is computed. Otherwise the fields are simply added up for the specified level range.

   top_level

   The top height level (inclusive) for the computations. Optional.

   bottom_level

   The bottom height level (inclusive) for the computations. Optional.

   step

   The forecast step to extract.

   release

   The release to extract. Release indexing starts at 1.

   ageclass

   The ageclass to extract. Ageclass indexing starts at 1.

   Example:

   # to compute the total column integrated mass for all the steps, releases and ageclasses

   g=flexpart_total_column(source: "my_flexpart_output.grib")


.. describe:: flexpart_convert_trajectory(raw_tr_file, outprefix)

   Converts the raw trajectory file generated by FLEXPART (raw_tr_file) into CSV format better suited to processing with Metview. There is a separate CSV file is produced for each FLEXPART release. The output file name convention is as follows:

   outprefix_rRRR.csv

   where RRR is the release number (starts from one) with leading zeros.